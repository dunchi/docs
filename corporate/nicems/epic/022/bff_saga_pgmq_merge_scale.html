<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BFF Saga íŒ¨í„´ í™•ì¥ì„± ê°œì„  ê°œë°œ ê¸°ë¡</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            margin: 0;
            padding: 2rem;
        }
        .header {
            text-align: center;
            margin-bottom: 3rem;
        }
        .header h1 {
            font-size: 2.5rem;
            color: #2c3e50;
        }
        .content-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            padding: 2rem 3rem;
        }
        .content-container h2 {
            color: #34495e;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 0.5rem;
            margin-top: 2rem;
        }
        .content-container h3 {
            color: #4a627a;
            margin-top: 1.5rem;
        }
        .content-container p, .content-container li {
            font-size: 1.1rem;
            line-height: 1.7;
            color: #555;
        }
        .content-container ul {
            padding-left: 20px;
        }
        .content-container code {
            background-color: #e9ecef;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
        }
        .content-container pre {
            background-color: #e9ecef;
            padding: 1rem;
            border-radius: 8px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .home-link {
            display: block;
            text-align: center;
            margin-top: 2rem;
            text-decoration: none;
            color: #007bff;
            font-weight: 500;
        }
        .meta-info {
            text-align: right;
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-top: 3rem;
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>BFF Saga íŒ¨í„´ í™•ì¥ì„± ê°œì„  ê°œë°œ ê¸°ë¡</h1>
    </header>

    <div class="content-container">
        <h2>ğŸ“‹ ê°œìš”</h2>
        <p>MSA(Microservices Architecture) í™˜ê²½ì˜ BFF(Backend For Frontend)ì—ì„œ Saga íŒ¨í„´ êµ¬í˜„ ì‹œ ë°œìƒí•œ í™•ì¥ì„± ë¬¸ì œì™€ ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ê°œë°œ ê³¼ì •ì„ ê¸°ë¡í•œ ë¬¸ì„œì…ë‹ˆë‹¤.</p>

        <h2>ğŸš¨ ë°œìƒí•œ ë¬¸ì œì </h2>
        <h3>ì£¼ìš” ë¬¸ì œ: ê¸°í•˜ê¸‰ìˆ˜ì  ì½”ë“œ ì¦ê°€</h3>
        <p>MSA ì•„í‚¤í…ì²˜ ì† BFFì˜ íŠ¹ì„±ìƒ ë‹¤ìŒê³¼ ê°™ì€ í™•ì¥ì„± ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:</p>
        <ul>
            <li><strong>ë„ë©”ì¸ ê¸°ëŠ¥ ì¦ê°€</strong>: í˜¸ì¶œí•´ì•¼ í•˜ëŠ” ë„ë©”ì¸ì˜ ê¸°ëŠ¥ì´ ì ì  ëŠ˜ì–´ë‚¨</li>
            <li><strong>ìˆœì„œ ì •ì˜ ì½”ë“œ í­ì¦</strong>: ìƒˆë¡œìš´ ë¹„ì¦ˆë‹ˆìŠ¤ í”Œë¡œìš°ë§ˆë‹¤ <code>registerXXXProcessingSaga()</code> ë©”ì„œë“œ í•„ìš”</li>
            <li><strong>1:1 ë§¤ì¹­ í•¨ìˆ˜ ì¦ê°€</strong>: ê° ìŠ¤í…ë³„ë¡œ ê°œë³„ execute/compensate í•¨ìˆ˜ê°€ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ì¦ê°€</li>
            <li><strong>Switch-case ë¬¸ í™•ì¥</strong>: <code>performExecute()</code>ì™€ <code>performCompensation()</code> ë©”ì„œë“œì˜ switchë¬¸ì´ ê³„ì† ì»¤ì§</li>
        </ul>
        <h3>í˜„ì¬ ì½”ë“œ êµ¬ì¡°ì˜ í•œê³„</h3>
        <pre><code>// ë¬¸ì œê°€ ë˜ëŠ” ê¸°ì¡´ êµ¬ì¡° ì˜ˆì‹œ
return switch (stepName) {
    case "VALIDATE_ORDER" -> executeValidateOrder(command);
    case "RESERVE_INVENTORY" -> executeReserveInventory(command);
    case "PROCESS_PAYMENT" -> executeProcessPayment(command);
    case "SHIP_ORDER" -> executeShipOrder(command);
    case "SEND_CONFIRMATION" -> executeSendConfirmation(command);
    // ìˆ˜ë°±-ìˆ˜ì²œê°œì˜ caseë¬¸ì´ ê³„ì† ì¶”ê°€ë  ì˜ˆì •...
    default -> throw new IllegalArgumentException("Unknown step for execute: " + stepName);
};</code></pre>
        <p><strong>ê²°ê³¼ì ìœ¼ë¡œ</strong>: Nê°œ ë„ë©”ì¸ Ã— Mê°œ ì¡°í•© ì‹œë‚˜ë¦¬ì˜¤ì˜ ì¡°í•© í­ë°œ ë°œìƒ</p>

        <h2>ğŸ”§ ì²« ë²ˆì§¸ í•´ê²° ì‹œë„</h2>
        <h3>ì ‘ê·¼ ë°©ë²•: ìŠ¤í…-í•¨ìˆ˜ 1:1 ì—°ê²° í•´ì œ</h3>
        <p>ë‹¤ìŒê³¼ ê°™ì€ ì•„ì´ë””ì–´ë¡œ ë¬¸ì œ í•´ê²°ì„ ì‹œë„í–ˆìŠµë‹ˆë‹¤:</p>
        <h4>í•µì‹¬ ì•„ì´ë””ì–´</h4>
        <ul>
            <li><strong>ë©”íƒ€ë°ì´í„° ê¸°ë°˜ ì ‘ê·¼</strong>: ì„œë²„ ì‹œì‘ ì‹œì ì— execute endpoint, compensate endpoint, do compensate or not ë“±ì˜ ì •ë³´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥</li>
            <li><strong>ì¶”ìƒí™”ëœ ë‹¨ì¼ ì²˜ë¦¬</strong>: ì‹¤í–‰ ì‹œì ì—ëŠ” í•˜ë“œì½”ë”©ëœ í•¨ìˆ˜ ë§¤ì¹­ ëŒ€ì‹ , ì €ì¥ëœ ë©”íƒ€ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ì—¬ í•˜ë‚˜ì˜ ì¶”ìƒí™”ëœ í•¨ìˆ˜ì—ì„œ ë™ì  ì²˜ë¦¬</li>
            <li><strong>ì„¤ì • ê¸°ë°˜ ì²˜ë¦¬</strong>: ì½”ë“œ ë ˆë²¨ì˜ í•˜ë“œì½”ë”©ì„ ì„¤ì • ë ˆë²¨ì˜ ë©”íƒ€ë°ì´í„°ë¡œ ì´ë™</li>
        </ul>
        <h4>ê¸°ëŒ€ íš¨ê³¼</h4>
        <ul>
            <li>Switch-case ë¬¸ ì œê±°</li>
            <li>ìƒˆë¡œìš´ ìŠ¤í… ì¶”ê°€ ì‹œ ì½”ë“œ ìˆ˜ì • ì—†ì´ ì„¤ì •ë§Œìœ¼ë¡œ ì²˜ë¦¬</li>
            <li>í™•ì¥ì„± ë¬¸ì œ ê·¼ë³¸ì  í•´ê²°</li>
        </ul>

        <h2>â›” ì²« ë²ˆì§¸ ì‹œë„ ì¤‘ë‹¨ ì´ìœ </h2>
        <h3>ë³µì¡í•˜ê²Œ ì–½íŒ êµ¬ì¡°ì  ë¬¸ì œë“¤</h3>
        <p>ë¦¬íŒ©í† ë§ì„ ì§„í–‰í•˜ë©´ì„œ ë‹¤ìŒê³¼ ê°™ì€ ë³µí•©ì ì¸ ë¬¸ì œë“¤ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤:</p>
        <h4>1. ë©”ì‹œì§€ êµ¬ì¡° ë¶ˆì¼ì¹˜</h4>
        <ul>
            <li><strong>execute, retry, compensateë§ˆë‹¤ ë©”ì‹œì§€ì˜ êµ¬ì¡°ê°€ ë‹¤ë¦„</strong></li>
            <li>í†µì¼ëœ ì¶”ìƒí™” ì ìš©ì˜ ì–´ë ¤ì›€</li>
        </ul>
        <h4>2. ì €ì¥ì†Œ í˜¼ì¬ ë¬¸ì œ</h4>
        <ul>
            <li><strong>sagaDefinitionê³¼ sagaStepDefinition</strong>: ë©”ëª¨ë¦¬ì— ì €ì¥</li>
            <li><strong>sagaInstanceì™€ sagaStep</strong>: ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥</li>
            <li>ë‘ ì €ì¥ì†Œ ê°„ì˜ ì¼ê´€ì„± ë° ë™ê¸°í™” ë³µì¡ì„±</li>
        </ul>
        <h4>3. ì°¸ì¡° êµ¬ì¡° ë³µì¡ì„±</h4>
        <ul>
            <li><strong>sagaInstanceì™€ sagaStep</strong>: sagaì™€ stepì— ëŒ€í•œ nameë§Œì„ keyë¡œ ì‚¬ìš©</li>
            <li><strong>ì‹¤ì œ ì—…ë¬´ ì •ë³´</strong>: url ë“±ì€ ë©”ëª¨ë¦¬ì—ì„œ nameìœ¼ë¡œ definitionì„ ì¡°íšŒí•´ì„œ ì°¸ê³ </li>
            <li>ê°„ì ‘ ì°¸ì¡°ë¡œ ì¸í•œ ë³µì¡í•œ ì˜ì¡´ì„±</li>
        </ul>
        <h4>4. ì§ì ‘ ë¦¬íŒ©í† ë§ì˜ í•œê³„</h4>
        <ul>
            <li>ì—¬ëŸ¬ ë¬¸ì œê°€ ì„œë¡œ ì–½í˜€ìˆì–´ ìˆœì°¨ì  í•´ê²°ì´ ì–´ë ¤ì›€</li>
            <li>ì „ì²´ êµ¬ì¡°ì— ëŒ€í•œ ê·¼ë³¸ì  ì¬ì„¤ê³„ í•„ìš”ì„± ì¸ì‹</li>
        </ul>

        <h2>ğŸ¤– AI í™œìš© ê²°ì •</h2>
        <h3>AI ë„ì›€ ìš”ì²­ ë°°ê²½</h3>
        <p>ë³µì¡í•˜ê²Œ ì–½íŒ êµ¬ì¡°ì  ë¬¸ì œë“¤ë¡œ ì¸í•´ ì§ì ‘ ë¦¬íŒ©í† ë§ì— í•œê³„ë¥¼ ëŠë¼ê³ , ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ ë¡œ AIì˜ ë„ì›€ì„ ìš”ì²­í–ˆìŠµë‹ˆë‹¤:</p>
        <ul>
            <li><strong>êµ¬ì¡°ì  ë³µì¡ì„±</strong>: ì—¬ëŸ¬ ë¬¸ì œê°€ ì„œë¡œ ì—°ê´€ë˜ì–´ ìˆì–´ ê°œë³„ í•´ê²°ì´ ì–´ë ¤ì›€</li>
            <li><strong>ì „ë¬¸ì„± ë¶€ì¡±</strong>: Spring Bootì™€ Saga íŒ¨í„´ì˜ ê³ ê¸‰ í™œìš©ë²•ì— ëŒ€í•œ ì§€ì‹ ë¶€ì¡±</li>
            <li><strong>ì„¤ê³„ ê´€ì </strong>: ì „ì²´ ì•„í‚¤í…ì²˜ ê´€ì ì—ì„œì˜ ê·¼ë³¸ì  í•´ê²°ì±… í•„ìš”</li>
            <li><strong>ê²€ì¦ëœ íŒ¨í„´</strong>: ì—…ê³„ì—ì„œ ê²€ì¦ëœ ëª¨ë²” ì‚¬ë¡€ì™€ íŒ¨í„´ ì ìš© í•„ìš”</li>
        </ul>

        <h2>ğŸ’¡ AI ì œì•ˆ í•´ê²°ë²•</h2>
        <h3>í•µì‹¬ ì ‘ê·¼ ë°©ì‹: ì„¤ì • ê¸°ë°˜ ë™ì  Saga ì‹¤í–‰ ì•„í‚¤í…ì²˜</h3>
        <p>AIê°€ ì œì•ˆí•œ í•´ê²°ì±…ì€ <strong>Strategy íŒ¨í„´ê³¼ Springì˜ ê³ ê¸‰ ê¸°ëŠ¥ì„ í™œìš©í•œ ë™ì  ì‹¤í–‰ í”„ë ˆì„ì›Œí¬</strong>ì…ë‹ˆë‹¤.</p>
        <h4>1. Strategy íŒ¨í„´ ê¸°ë°˜ Handler êµ¬ì¡°</h4>
        <p><strong>ê¸°ì¡´ Switch-case ì œê±°</strong>:</p>
        <pre><code>// Handler ì¸í„°í˜ì´ìŠ¤ ë„ì…
public interface SagaStepHandler {
    String getStepType();
    SagaStepResult execute(SagaContext context);
    SagaStepResult compensate(SagaContext context);
}

// ë™ì  Handler ê´€ë¦¬
@Service
public class SagaStepRegistry {
    private final Map&lt;String, SagaStepHandler&gt; handlers;
    
    public SagaStepHandler getHandler(String stepType) {
        return handlers.get(stepType);
    }
}</code></pre>
        <h4>2. ì„¤ì • ê¸°ë°˜ ì›Œí¬í”Œë¡œìš° ì •ì˜</h4>
        <p><strong>YAML ì„¤ì •ìœ¼ë¡œ ì›Œí¬í”Œë¡œìš° ê´€ë¦¬</strong>:</p>
        <pre><code>saga:
  workflows:
    order-processing:
      steps:
        - name: payment
          service-endpoint: "http://payment-service/api/v1/charge"
          compensation-endpoint: "http://payment-service/api/v1/refund"
          timeout: 30s
          retries: 3
          is-compensatable: true</code></pre>
        <h4>3. WebClient ê¸°ë°˜ ë™ì  API í˜¸ì¶œ</h4>
        <p><strong>ë™ì  ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ ì‹œìŠ¤í…œ</strong>:</p>
        <pre><code>@Service
public class DynamicApiService {
    public &lt;T&gt; Mono&lt;T&gt; callServiceEndpoint(String endpoint, Object request, Class&lt;T&gt; responseType) {
        return webClient.post()
            .uri(endpoint)
            .bodyValue(request)
            .retrieve()
            .retryWhen(Retry.backoff(3, Duration.ofMillis(500)))
            .timeout(Duration.ofSeconds(30));
    }
}</code></pre>
        <h4>4. ì™„ì „í•œ ì¶”ìƒí™” êµ¬í˜„</h4>
        <p><strong>ë™ì  ì‹¤í–‰ ì—”ì§„</strong>:</p>
        <ul>
            <li>ApplicationContextì™€ ë¦¬í”Œë ‰ì…˜ í™œìš©</li>
            <li>Handler ê¸°ë°˜ ì‹¤í–‰ vs API í˜¸ì¶œ ë™ì  ì„ íƒ</li>
            <li>AOPë¥¼ í™œìš©í•œ íš¡ë‹¨ ê´€ì‹¬ì‚¬ ì²˜ë¦¬</li>
        </ul>
        <h3>ê¸°ëŒ€ íš¨ê³¼</h3>
        <ul>
            <li><strong>ì½”ë“œ ì¤‘ë³µ 95% ê°ì†Œ</strong>: Handler íŒ¨í„´ìœ¼ë¡œ ê³µí†µ ë¡œì§ ì¶”ìƒí™”</li>
            <li><strong>ì‹ ê·œ Step ì¶”ê°€ ì‹œê°„ 90% ë‹¨ì¶•</strong>: ì„¤ì • íŒŒì¼ë§Œ ìˆ˜ì •í•˜ë©´ ì¦‰ì‹œ ì ìš©</li>
            <li><strong>ìˆ˜ì²œê°œ í•¨ìˆ˜ ì§€ì›</strong>: ë™ì  ë¡œë”© ë° ì§€ì—° ì´ˆê¸°í™”</li>
            <li><strong>ë¬´ì¤‘ë‹¨ ë°°í¬</strong>: ì„¤ì • ë³€ê²½ë§Œìœ¼ë¡œ ì›Œí¬í”Œë¡œìš° ìˆ˜ì • ê°€ëŠ¥</li>
        </ul>

        <h2>ğŸ“‹ ë‹¨ê³„ë³„ êµ¬í˜„ ê³„íš</h2>
        <h3>Phase 1: ê¸°ë°˜ êµ¬ì¡° ë§ˆë ¨ (1-2ì£¼)</h3>
        <ol>
            <li>Handler ì¸í„°í˜ì´ìŠ¤ ë„ì…</li>
            <li>Registry íŒ¨í„´ êµ¬í˜„</li>
            <li>ì„¤ì • íŒŒì¼ ì •ì˜</li>
        </ol>
        <h3>Phase 2: ë™ì  ì‹¤í–‰ ì—”ì§„ êµ¬ì¶• (2-3ì£¼)</h3>
        <ol>
            <li>WebClient í†µí•©</li>
            <li>ë¦¬í”Œë ‰ì…˜ ê¸°ë°˜ ì‹¤í–‰ êµ¬í˜„</li>
            <li>AOP í†µí•©</li>
        </ol>
        <h3>Phase 3: ê³ ë„í™” ë° ìµœì í™” (2-4ì£¼)</h3>
        <ol>
            <li>Enterprise ë¼ì´ë¸ŒëŸ¬ë¦¬ í†µí•©</li>
            <li>ë¹„ë™ê¸° ì²˜ë¦¬ ìµœì í™”</li>
            <li>ëª¨ë‹ˆí„°ë§ ì²´ê³„ ê°•í™”</li>
        </ol>

        <h2>ğŸ¯ ê²°ë¡ </h2>
        <p>MSA í™˜ê²½ì—ì„œ BFFì˜ Saga íŒ¨í„´ í™•ì¥ì„± ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì—¬ì •ì„ ê±°ì³¤ìŠµë‹ˆë‹¤:</p>
        <ol>
            <li><strong>ë¬¸ì œ ì¸ì‹</strong>: ê¸°í•˜ê¸‰ìˆ˜ì  ì½”ë“œ ì¦ê°€ ë¬¸ì œ ë°œê²¬</li>
            <li><strong>ì§ì ‘ ì‹œë„</strong>: ìŠ¤í…-í•¨ìˆ˜ 1:1 ì—°ê²° í•´ì œ ì‹œë„</li>
            <li><strong>í•œê³„ ì¸ì‹</strong>: ë³µì¡í•œ êµ¬ì¡°ì  ë¬¸ì œë¡œ ì¸í•œ ì¤‘ë‹¨</li>
            <li><strong>AI í™œìš©</strong>: ì „ë¬¸ì  í•´ê²°ì±… ë„ì¶œ</li>
            <li><strong>í•´ê²° ë°©í–¥</strong>: ì„¤ì • ê¸°ë°˜ ë™ì  ì‹¤í–‰ ì•„í‚¤í…ì²˜ ì±„íƒ</li>
        </ol>
        <p>ì´ë¥¼ í†µí•´ <strong>ìœ ì—°í•˜ê³  í™•ì¥ ê°€ëŠ¥í•œ Saga íŒ¨í„´ êµ¬í˜„</strong>ì´ ê°€ëŠ¥í•´ì§ˆ ê²ƒìœ¼ë¡œ ê¸°ëŒ€ë©ë‹ˆë‹¤.</p>

        <div class="meta-info">
            <p><em>ì‘ì„±ì¼: 2025ë…„ 6ì›” 27ì¼</em></p>
            <p><em>ì‘ì„±ì: ê¹€í•œì£¼</em></p>
        </div>

        <a href="../index.html" class="home-link">&larr; ì´ì „ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>
</body>
</html>